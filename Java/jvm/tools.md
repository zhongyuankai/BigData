# 常用工具+实战

## Linux 监控和排查工具

- `top`：显示当前系统正在执行的进程的相关信息，包括进程ID、内存占用率、CPU占用率等
- `vmstat`：可以展现给定时间间隔的服务器的状态值,包括服务器的CPU使用率，内存使用，虚拟内存交换情况,IO读写情况
- `free`：应用程序可用内存数
- `df`：查看磁盘剩余空闲数
- `iostat`：磁盘I/O性能评估
- `ifstat`：查看网络IO；默认本地没有，需要下载ifstat

## JVM 监控和性能分析工具

- `jps`：虚拟机进程状况工具
- `jinfo`：Java配置信息工具，实时查看和调整虚拟机的各项参数
- `jmap`：内存映像工具，生产堆转储快照
- `jstat`：统计信息监控工具，显示本地或远程虚拟机的类装载、内存、垃圾收集、JIT编译等运行数据。
- `jstack`：用于生成虚拟机当前时刻的线程快照。


## 生产环境出现CPU占用过高的分析思路和定位

1. 先用`top`命令找出CPU占比最高的；
2. `ps -ef`或者`jps`进一步定位，得知是一个怎么样的一个后台程序；
3. `ps -mp 进程 -o THREAD,tid,time`（`-m` 显示所有线程，`-p` pid进程使用cpu的时间，`-o` 该参数后是用户自定义格式）定位到具体线程或者代码，；
4. `printf "%x\n"` 有问题的线程ID 将需要的线程ID转换为16进制格式(英文小写格式)；
5. `jstack 进程ID | grep tid(16进制线程ID小写英文) -A60`

